/**
 * HW7
 * Gauss-Seidel And SOR Algorithm for solving linear equations
 * Result:
Gauss-Seidel Result:
x=(
-0.289232905565641,
0.345436423215643,
-0.712811347533117,
-0.220608229713035,
-0.430400149085528,
0.154309255319161,
-0.057822496107931,
0.201053960704502,
0.290228753585920,
)
iterative steps:18
SOR Result:
x=(
-0.289233288578305,
0.345435696830607,
-0.712811451937312,
-0.220608518079118,
-0.430400191009483,
0.154308722284534,
-0.057822329548771,
0.201053892728155,
0.290228751046000,
)
iterative steps:38
x=(
-0.289233079026053,
0.345435854925617,
-0.712811343343939,
-0.220608454382174,
-0.430400097638238,
0.154308905634722,
-0.057822126976596,
0.201053917201617,
0.290228785092864,
)
iterative steps:36
x=(
-0.289232696392601,
0.345436131511613,
-0.712811144030249,
-0.220608342995153,
-0.430399926153608,
0.154309222554098,
-0.057821752579288,
0.201053959382123,
0.290228847836706,
)
iterative steps:34
x=(
-0.289232004230341,
0.345436634034659,
-0.712810782873450,
-0.220608140615603,
-0.430399615593913,
0.154309793016441,
-0.057821074817035,
0.201054035251792,
0.290228961624031,
)
iterative steps:32
x=(
-0.289230744786180,
0.345437564513886,
-0.712810125350641,
-0.220607765739835,
-0.430399050945389,
0.154310840551937,
-0.057819847309333,
0.201054174713877,
0.290229168691928,
)
iterative steps:30
x=(
-0.289222624760991,
0.345442727806332,
-0.712805876349711,
-0.220605679485925,
-0.430395414694144,
0.154316628997410,
-0.057812022780132,
0.201054954924756,
0.290230506042014,
)
iterative steps:26
x=(
-0.289231556844215,
0.345437459596328,
-0.712810551710276,
-0.220607808853819,
-0.430399418276077,
0.154310690655555,
-0.057820656245590,
0.201054153073817,
0.290229033613800,
)
iterative steps:30
x=(
-0.289059854118179,
0.345539605583869,
-0.712718539072829,
-0.220565742894631,
-0.430322607706464,
0.154418255441788,
-0.057666364836685,
0.201069899431888,
0.290258008599190,
)
iterative steps:18
x=(
-0.289232660765915,
0.345436808733364,
-0.712811126541755,
-0.220608071290048,
-0.430399911573790,
0.154309940057941,
-0.057821727471533,
0.201054052635255,
0.290228852963541,
)
iterative steps:31
x=(
-0.289232769273211,
0.345436683808366,
-0.712811185653605,
-0.220608121580004,
-0.430399963106780,
0.154309800424896,
-0.057821847251331,
0.201054034120540,
0.290228833648873,
)
iterative steps:31
x=(
-0.289232426941122,
0.345436934713165,
-0.712811011552948,
-0.220608020722373,
-0.430399814870039,
0.154310075251896,
-0.057821537617340,
0.201054070257562,
0.290228887191083,
)
iterative steps:30
x=(
-0.289232578187844,
0.345436809151929,
-0.712811091728006,
-0.220608071294843,
-0.430399884110729,
0.154309932469612,
-0.057821692305326,
0.201054051258309,
0.290228861595486,
)
iterative steps:30
x=(
-0.289232713847712,
0.345436692310300,
-0.712811163551842,
-0.220608118333295,
-0.430399946138713,
0.154309800485229,
-0.057821830687001,
0.201054033738986,
0.290228838687037,
)
iterative steps:30
x=(
-0.289232836193041,
0.345436584703454,
-0.712811228192273,
-0.220608161636325,
-0.430400001948716,
0.154309679617075,
-0.057821954867837,
0.201054017729499,
0.290228818103117,
)
iterative steps:30
x=(
-0.289232543389537,
0.345436850242118,
-0.712811079453957,
-0.220608055029094,
-0.430399875170339,
0.154309959595415,
-0.057821690953321,
0.201054054270279,
0.290228863822019,
)
iterative steps:29
x=(
-0.289232683845036,
0.345436721486660,
-0.712811153527105,
-0.220608106820979,
-0.430399939111942,
0.154309816821332,
-0.057821832587898,
0.201054035402835,
0.290228840270777,
)
iterative steps:29
x=(
-0.289232812011400,
0.345436604942672,
-0.712811220824260,
-0.220608153685455,
-0.430399997137717,
0.154309688000930,
-0.057821960344652,
0.201054018408592,
0.290228818952339,
)
iterative steps:29
x=(
-0.289232928517446,
0.345436499603011,
-0.712811281739931,
-0.220608196030875,
-0.430400049602782,
0.154309571982168,
-0.057822075173085,
0.201054003129986,
0.290228799724366,
)
iterative steps:29
x=(
-0.289232647515289,
0.345436744726150,
-0.712811141426043,
-0.220608097678914,
-0.430399930866041,
0.154309826256624,
-0.057821835290940,
0.201054036166019,
0.290228842131611,
)
iterative steps:28
x=(
-0.289232785400158,
0.345436621255082,
-0.712811213031806,
-0.220608147300636,
-0.430399992373660,
0.154309691298868,
-0.057821968293370,
0.201054018423757,
0.290228819672626,
)
iterative steps:28
x=(
-0.289232910002700,
0.345436509874401,
-0.712811277473935,
-0.220608192048660,
-0.430400047670655,
0.154309570108870,
-0.057822087158647,
0.201054002521381,
0.290228799531023,
)
iterative steps:28
x=(
-0.289232613393915,
0.345436767739029,
-0.712811131021236,
-0.220608088636269,
-0.430399924347394,
0.154309832812639,
-0.057821843342064,
0.201054036545449,
0.290228843289751,
)
iterative steps:27
x=(
-0.289232760988722,
0.345436636164601,
-0.712811206865377,
-0.220608141481682,
-0.430399989265360,
0.154309691037412,
-0.057821981207907,
0.201054017975017,
0.290228819729076,
)
iterative steps:27
x=(
-0.289232893889610,
0.345436518038866,
-0.712811274850492,
-0.220608188910815,
-0.430400047383651,
0.154309564370578,
-0.057822103806470,
0.201054001415839,
0.290228798692958,
)
iterative steps:27
x=(
-0.289232580293486,
0.345436788259367,
-0.712811121943493,
-0.220608080592671,
-0.430399919414068,
0.154309834424327,
-0.057821856999397,
0.201054036282027,
0.290228843773232,
)
iterative steps:26
x=(
-0.289232738649903,
0.345436648166382,
-0.712811202376408,
-0.220608136826517,
-0.430399987964310,
0.154309685767803,
-0.057821999638690,
0.201054016883142,
0.290228819059528,
)
iterative steps:26
x=(
-0.289232880570481,
0.345436522984152,
-0.712811274113689,
-0.220608187060089,
-0.430400049017034,
0.154309553659630,
-0.057822125735595,
0.201053999678541,
0.290228797112526,
)
iterative steps:26
x=(
-0.289233007315027,
0.345436411528268,
-0.712811337864894,
-0.220608231773041,
-0.430400103191386,
0.154309436710194,
-0.057822236759820,
0.201053984478442,
0.290228777695571,
)
iterative steps:26
x=(
-0.289232719704313,
0.345436656413374,
-0.712811200211259,
-0.220608133678958,
-0.430399989055827,
0.154309674392917,
-0.057822024651981,
0.201054015017914,
0.290228817464634,
)
iterative steps:25
x=(
-0.289232871250033,
0.345436523806788,
-0.712811275836178,
-0.220608186861560,
-0.430400053087255,
0.154309536946436,
-0.057822153827080,
0.201053997188086,
0.290228794617340,
)
iterative steps:25
x=(
-0.289233005840203,
0.345436406431415,
-0.712811342643067,
-0.220608233923654,
-0.430400109552331,
0.154309416074034,
-0.057822266744750,
0.201053981540422,
0.290228774534324,
)
iterative steps:25
x=(
-0.289232705569394,
0.345436659564421,
-0.712811201065312,
-0.220608132579189,
-0.430399993192507,
0.154309655457085,
-0.057822057392684,
0.201054012206495,
0.290228814725288,
)
iterative steps:24
x=(
-0.289232867350203,
0.345436519249747,
-0.712811280678812,
-0.220608188822040,
-0.430400060195468,
0.154309512954912,
-0.057822189029854,
0.201053993794744,
0.290228791011046,
)
iterative steps:24
x=(
-0.289233010117375,
0.345436395880962,
-0.712811350530837,
-0.220608238261407,
-0.430400118859157,
0.154309388591601,
-0.057822303139976,
0.201053977760142,
0.290228770320765,
)
iterative steps:24
x=(
-0.289232698227125,
0.345436655924198,
-0.712811205858262,
-0.220608134213885,
-0.430400001210485,
0.154309627216311,
-0.057822099167817,
0.201054008244473,
0.290228810568618,
)
iterative steps:23
x=(
-0.289232870778407,
0.345436507726588,
-0.712811289486190,
-0.220608193584415,
-0.430400071089714,
0.154309480181211,
-0.057822232382353,
0.201053989324257,
0.290228786056390,
)
iterative steps:23
x=(
-0.289233021930866,
0.345436378435910,
-0.712811362283023,
-0.220608245371087,
-0.430400131762477,
0.154309353010768,
-0.057822346723376,
0.201053972994423,
0.290228764854996,
)
iterative steps:23
x=(
-0.289232700354149,
0.345436643252832,
-0.712811215776070,
-0.220608139493340,
-0.430400014165224,
0.154309587552004,
-0.057822151430776,
0.201054002886279,
0.290228804660338,
)
iterative steps:22
x=(
-0.289232884070979,
0.345436487185666,
-0.712811303330496,
-0.220608201983978,
-0.430400086696001,
0.154309436850770,
-0.057822284981438,
0.201053983573365,
0.290228779469215,
)
iterative steps:22
x=(
-0.289233043612080,
0.345436352271898,
-0.712811378839899,
-0.220608255997478,
-0.430400149048364,
0.154309307907846,
-0.057822398251704,
0.201053967082471,
0.290228757904511,
)
iterative steps:22
x=(
-0.289232715645698,
0.345436618568062,
-0.712811232376778,
-0.220608149636604,
-0.430400033404320,
0.154309533897715,
-0.057822215756972,
0.201053995837744,
0.290228796587989,
)
iterative steps:21
x=(
-0.289232910661702,
0.345436454947128,
-0.712811323593548,
-0.220608215119519,
-0.430400108168405,
0.154309380890040,
-0.057822347923973,
0.201053976307066,
0.290228770908717,
)
iterative steps:21
x=(
-0.289233078254028,
0.345436315057524,
-0.712811401387186,
-0.220608271100505,
-0.430400171667101,
0.154309251702409,
-0.057822458374005,
0.201053959847608,
0.290228749200794,
)
iterative steps:21
x=(
-0.289232749304348,
0.345436577824316,
-0.712811257746412,
-0.220608166311298,
-0.430400060667523,
0.154309463158749,
-0.057822293768239,
0.201053986746997,
0.290228785839349,
)
iterative steps:20
x=(
-0.289232955291506,
0.345436407450623,
-0.712811352089818,
-0.220608234465497,
-0.430400136953864,
0.154309309923678,
-0.057822422180683,
0.201053967257542,
0.290228759966314,
)
iterative steps:20
x=(
-0.289233130033921,
0.345436263772363,
-0.712811431444930,
-0.220608291938301,
-0.430400200762689,
0.154309182726935,
-0.057822527463159,
0.201053951103682,
0.290228738438326,
)
iterative steps:20
x=(
-0.289232808855836,
0.345436515398114,
-0.712811294758541,
-0.220608191863665,
-0.430400098229695,
0.154309371666930,
-0.057822386940148,
0.201053975196248,
0.290228771773214,
)
iterative steps:19
x=(
-0.289233024674231,
0.345436339861199,
-0.712811391267136,
-0.220608262051041,
-0.430400174869535,
0.154309221367382,
-0.057822508319241,
0.201053956130106,
0.290228746155368,
)
iterative steps:19
x=(
-0.289233204713258,
0.345436194441264,
-0.712811471005231,
-0.220608320189993,
-0.430400237683051,
0.154309099450336,
-0.057822605268723,
0.201053940674654,
0.290228725283286,
)
iterative steps:19
x=(
-0.289232905565641,
0.345436423215643,
-0.712811347533117,
-0.220608229713035,
-0.430400149085528,
0.154309255319161,
-0.057822496107931,
0.201053960704502,
0.290228753585920,
)
iterative steps:18
x=(
-0.289233128607593,
0.345436245438512,
-0.712811444546803,
-0.220608300743592,
-0.430400224148796,
0.154309112841336,
-0.057822605855764,
0.201053942634857,
0.290228728917455,
)
iterative steps:18
x=(
-0.289233310397939,
0.345436101774774,
-0.712811522735982,
-0.220608358111132,
-0.430400283878747,
0.154309001156000,
-0.057822690140118,
0.201053928455272,
0.290228709421727,
)
iterative steps:18
x=(
-0.289233057030984,
0.345436289205701,
-0.712811422296298,
-0.220608285022627,
-0.430400217069072,
0.154309110461317,
-0.057822620131049,
0.201053942787195,
0.290228730311331,
)
iterative steps:17
x=(
-0.289233281852992,
0.345436114564682,
-0.712811516887201,
-0.220608354626771,
-0.430400287212263,
0.154308983680983,
-0.057822711602909,
0.201053926616699,
0.290228707723875,
)
iterative steps:17
x=(
-0.289233011379048,
0.345436308057856,
-0.712811413880508,
-0.220608280916670,
-0.430400224663868,
0.154309078026959,
-0.057822656793884,
0.201053939375448,
0.290228726923203,
)
iterative steps:16
x=(
-0.289233292359401,
0.345436094446906,
-0.712811529033729,
-0.220608365643299,
-0.430400306186404,
0.154308937734374,
-0.057822751976588,
0.201053921282955,
0.290228701088953,
)
iterative steps:16
x=(
-0.289233046348473,
0.345436258801309,
-0.712811442972710,
-0.220608307240554,
-0.430400263819154,
0.154308990617390,
-0.057822728103541,
0.201053929127130,
0.290228713672375,
)
iterative steps:15
x=(
-0.289233403326615,
0.345435995337240,
-0.712811584287469,
-0.220608410141258,
-0.430400355474980,
0.154308845514260,
-0.057822817260922,
0.201053909891672,
0.290228685228028,
)
iterative steps:15
x=(
-0.289233314046552,
0.345436020832567,
-0.712811577148384,
-0.220608414539440,
-0.430400371630267,
0.154308806895875,
-0.057822845807255,
0.201053905752741,
0.290228679693414,
)
iterative steps:14
x=(
-0.289233325918716,
0.345435870498223,
-0.712811690542999,
-0.220608527758162,
-0.430400488843275,
0.154308622713591,
-0.057822948102680,
0.201053881847276,
0.290228642458892,
)
iterative steps:13
x=(
-0.289228035244673,
0.345438179586929,
-0.712811045528369,
-0.220608951529273,
-0.430401493921371,
0.154306797796490,
-0.057824027454230,
0.201053662084834,
0.290228295248009,
)
iterative steps:11
x=(
-0.289234338714836,
0.345435333492295,
-0.712811936958721,
-0.220608641758639,
-0.430400500341082,
0.154308701095036,
-0.057822861119222,
0.201053885771283,
0.290228643852664,
)
iterative steps:14
x=(
-0.289234434646520,
0.345435304501100,
-0.712811944565037,
-0.220608623269445,
-0.430400450943419,
0.154308808389554,
-0.057822791036843,
0.201053897774607,
0.290228660787022,
)
iterative steps:14
x=(
-0.289234420653696,
0.345435367650209,
-0.712811899045153,
-0.220608558406547,
-0.430400360002808,
0.154308968481116,
-0.057822704398493,
0.201053917126724,
0.290228690464779,
)
iterative steps:14
x=(
-0.289234299542056,
0.345435522707750,
-0.712811799747481,
-0.220608445665852,
-0.430400228775033,
0.154309172069453,
-0.057822613561275,
0.201053942825159,
0.290228732276503,
)
iterative steps:14
x=(
-0.289234069993405,
0.345435772987769,
-0.712811644204147,
-0.220608282040006,
-0.430400057381773,
0.154309411085822,
-0.057822531219296,
0.201053973958375,
0.290228785869134,
)
iterative steps:14
x=(
-0.289233522565624,
0.345435954033770,
-0.712811595689690,
-0.220608399584039,
-0.430400367672204,
0.154308763942270,
-0.057822918252280,
0.201053900839244,
0.290228677995218,
)
iterative steps:16
x=(
-0.289233417597148,
0.345436023498304,
-0.712811557079336,
-0.220608372012629,
-0.430400369788384,
0.154308713030201,
-0.057822976230798,
0.201053896325903,
0.290228674945608,
)
iterative steps:16
x=(
-0.289235251859677,
0.345435312736338,
-0.712811786845227,
-0.220607550194690,
-0.430398256224957,
0.154312910806235,
-0.057820638670635,
0.201054390999511,
0.290229421642663,
)
iterative steps:13
x=(
-0.289233715244768,
0.345435743416357,
-0.712811710823149,
-0.220608514264486,
-0.430400506510493,
0.154308525540992,
-0.057823019786156,
0.201053873844871,
0.290228636021109,
)
iterative steps:17
x=(
-0.289233760757216,
0.345435687285775,
-0.712811737505958,
-0.220608544308120,
-0.430400559790689,
0.154308411515121,
-0.057823076997853,
0.201053862103574,
0.290228619386770,
)
iterative steps:17
x=(
-0.289233841873744,
0.345435598452207,
-0.712811779435001,
-0.220608589050161,
-0.430400633357941,
0.154308258907674,
-0.057823146437854,
0.201053846572985,
0.290228596963873,
)
iterative steps:17
x=(
-0.289233970584163,
0.345435466832983,
-0.712811840781681,
-0.220608652341364,
-0.430400732508479,
0.154308057346799,
-0.057823229481906,
0.201053826405276,
0.290228567437181,
)
iterative steps:17
x=(
-0.289234162249865,
0.345435279678522,
-0.712811926638228,
-0.220608738830740,
-0.430400863822470,
0.154307793476843,
-0.057823327742545,
0.201053800557387,
0.290228529226320,
)
iterative steps:17
x=(
-0.289234436481711,
0.345435020904878,
-0.712812043216187,
-0.220608854113538,
-0.430401035455109,
0.154307450129607,
-0.057823443144173,
0.201053767744515,
0.290228480437394,
)
iterative steps:17
x=(
-0.289234283285183,
0.345435436167144,
-0.712811862049286,
-0.220608673580911,
-0.430400523308436,
0.154308833969253,
-0.057822588001990,
0.201053899951312,
0.290228647641582,
)
iterative steps:19
x=(
-0.289233900384144,
0.345435716763559,
-0.712811744011202,
-0.220608543165707,
-0.430400376323296,
0.154309039131001,
-0.057822608715624,
0.201053920312194,
0.290228683393224,
)
iterative steps:20
x=(
-0.289233886539717,
0.345435754577943,
-0.712811731288698,
-0.220608542771450,
-0.430400340609255,
0.154309184412107,
-0.057822495847892,
0.201053932759694,
0.290228695140807,
)
iterative steps:20
x=(
-0.289233855859851,
0.345435814813440,
-0.712811710015443,
-0.220608539831313,
-0.430400290262988,
0.154309386654326,
-0.057822341838200,
0.201053949909444,
0.290228711298717,
)
iterative steps:20
x=(
-0.289233801013294,
0.345435906131894,
-0.712811676847602,
-0.220608533439929,
-0.430400220696399,
0.154309665051477,
-0.057822133070364,
0.201053973246400,
0.290228733140577,
)
iterative steps:20
x=(
-0.289233712386533,
0.345436039880451,
-0.712811627388788,
-0.220608522505153,
-0.430400126150415,
0.154310044514260,
-0.057821851714549,
0.201054004663739,
0.290228762234938,
)
iterative steps:20
x=(
-0.289233577531412,
0.345436230793230,
-0.712811555898564,
-0.220608505727773,
-0.430399999460076,
0.154310557152320,
-0.057821474523598,
0.201054046558431,
0.290228800496028,
)
iterative steps:20
x=(
-0.289232680233576,
0.345436569181156,
-0.712811460305331,
-0.220608227089535,
-0.430399869393671,
0.154310034062569,
-0.057822510644550,
0.201054008496832,
0.290228805570038,
)
iterative steps:21
x=(
-0.289237755459657,
0.345425408330665,
-0.712817200162345,
-0.220611424197852,
-0.430409417834474,
0.154279257618242,
-0.057844326122689,
0.201051239931819,
0.290225544159410,
)
iterative steps:16
x=(
-0.289239698512983,
0.345421787621068,
-0.712819137572902,
-0.220612315910463,
-0.430411706044568,
0.154271153167024,
-0.057850330396203,
0.201050566675765,
0.290224784474724,
)
iterative steps:16
x=(
-0.289234000449562,
0.345435475872852,
-0.712811798883108,
-0.220608500143134,
-0.430400611864569,
0.154307938472040,
-0.057823491698722,
0.201053827837880,
0.290228607329016,
)
iterative steps:24
x=(
-0.289234104343365,
0.345435358680608,
-0.712811836192519,
-0.220608502581049,
-0.430400686509987,
0.154307610445913,
-0.057823736991735,
0.201053800787070,
0.290228585622794,
)
iterative steps:24
x=(
-0.289234251129312,
0.345435194882861,
-0.712811889266518,
-0.220608506500927,
-0.430400787234862,
0.154307162644194,
-0.057824072166730,
0.201053764098086,
0.290228556640832,
)
iterative steps:24
x=(
-0.289234833787527,
0.345435014499866,
-0.712811924831353,
-0.220608733304839,
-0.430400924707979,
0.154307610083785,
-0.057823098305874,
0.201053792646020,
0.290228536370991,
)
iterative steps:25
x=(
-0.289235226599125,
0.345434749548944,
-0.712811993734100,
-0.220608811656808,
-0.430401104051723,
0.154307189553187,
-0.057823159036112,
0.201053755472919,
0.290228492256184,
)
iterative steps:25
x=(
-0.289235753515378,
0.345434394868991,
-0.712812084271228,
-0.220608913396887,
-0.430401341947086,
0.154306623312815,
-0.057823237756419,
0.201053705800976,
0.290228434302031,
)
iterative steps:25
x=(
-0.289236455129448,
0.345433923015031,
-0.712812202601372,
-0.220609044327756,
-0.430401655411398,
0.154305864324607,
-0.057823341454340,
0.201053639740256,
0.290228358670058,
)
iterative steps:25
x=(
-0.289237382858046,
0.345433298955580,
-0.712812356519807,
-0.220609211371800,
-0.430402065791447,
0.154304851501567,
-0.057823480317913,
0.201053552288324,
0.290228260604071,
)
iterative steps:25
x=(
-0.289238601443070,
0.345432478188916,
-0.712812555876366,
-0.220609422702762,
-0.430402599695305,
0.154303505884587,
-0.057823669132113,
0.201053437043055,
0.290228134251813,
)
iterative steps:25
x=(
-0.289240191939964,
0.345431404445382,
-0.712812813096903,
-0.220609687869120,
-0.430403290081200,
0.154301725895238,
-0.057823929197282,
0.201053285850776,
0.290227972463204,
)
iterative steps:25
x=(
-0.289242255268265,
0.345430006897509,
-0.712813143832352,
-0.220610017899645,
-0.430404177519180,
0.154299381474302,
-0.057824290929678,
0.201053088377958,
0.290227766565405,
)
iterative steps:25
x=(
-0.289244916408100,
0.345428196787788,
-0.712813567764146,
-0.220610425378494,
-0.430405311640071,
0.154296306884986,
-0.057824797343102,
0.201052831593217,
0.290227506116285,
)
iterative steps:25
x=(
-0.289248329335234,
0.345425863370581,
-0.712814109600238,
-0.220610924473545,
-0.430406752783882,
0.154292291925625,
-0.057825508656195,
0.201052499145072,
0.290227178639845,
)
iterative steps:25
x=(
-0.289252682796662,
0.345422869049878,
-0.712814800302034,
-0.220611530897201,
-0.430408573856077,
0.154287071259373,
-0.057826508323018,
0.201052070619636,
0.290226769349711,
)
iterative steps:25
最佳松弛因子:1.220000000000000，迭代步数:11
 */
#include <stdio.h>
#include <math.h>
#include <limits.h>

#define MATRIX_SIZE 9
#define ERROR_THRESHOLD 1E-7


typedef struct {
    int steps;
    double x[MATRIX_SIZE];
} RES;

/**
 * @brief Gauss-Seidel Algorithm for solving linear equations Ax = b with error ERROR_THRESHOLD
 * @param A input: Coefficient matrix
 * @param b input: Constant terms
 * @param x output: The unknowns
 */
void gaussSeidel(double A[][MATRIX_SIZE], double b[MATRIX_SIZE], RES *result) {
    int flag = 0; // 指示|x-x1|的无穷范数是否小于误差限
    double x1[9] = {0};
    result->steps = 0;
    while (flag == 0) {
        result->steps++;
        for (int i = 0; i < MATRIX_SIZE; i++) {
            x1[i] = result->x[i];
        }
        for (int i = 0; i < MATRIX_SIZE; i++) {
            double s = 0;
            for (int j = 0; j < MATRIX_SIZE; j++) {
                s = s + A[i][j] * result->x[j];
            }
            result->x[i] = (b[i] - s + A[i][i] * x1[i]) / A[i][i];
        }
        // 检验迭代是否结束
        for (int i = 0; i < MATRIX_SIZE; i++) {
            flag = 1;
            if (fabs(result->x[i] - x1[i]) > ERROR_THRESHOLD) {
                flag = 0;
            }
        }
    }
}

/**
 * @brief SOR Algorithm for solving linear equations Ax=b with error ERROR_THRESHOLD
 * @param A input: Coefficient matrix
 * @param b input: Constant terms
 * @param w input: relaxation factor
 * @param x output: The unknowns
 */
void SOR(double A[][MATRIX_SIZE], double b[MATRIX_SIZE], double w, RES *result) {
    int flag = 0; // 指示|x-x1|的无穷范数是否小于误差限
    double x1[9] = {0};
    result->steps = 0;
    while (flag == 0) {
        result->steps++;
        for (int i = 0; i < MATRIX_SIZE; i++) {
            x1[i] = result->x[i];
        }
        for (int i = 0; i < MATRIX_SIZE; i++) {
            double s = 0;
            for (int j = 0; j < MATRIX_SIZE; j++) {
                s = s + A[i][j] * ((1 - w) * x1[j] + w * result->x[j]);
            }
            result->x[i] = (b[i] - s + A[i][i] * x1[i]) / A[i][i];
        }
        // 检验迭代是否结束
        for (int i = 0; i < MATRIX_SIZE; i++) {
            flag = 1;
            if (fabs(result->x[i] - x1[i]) > ERROR_THRESHOLD) {
                flag = 0;
            }
        }
    }
}

int main() {
    double A[9][9] = {
            {31,  -13, 0,   0,   0,   -10, 0,   0,  0},
            {-13, 35,  -9,  0,   -11, 0,   0,   0,  0},
            {0,   -9,  31,  -10, 0,   0,   0,   0,  0},
            {0,   0,   -10, 79,  -30, 0,   0,   0,  -9},
            {0,   0,   0,   -30, 57,  -7,  0,   -5, 0},
            {0,   0,   0,   0,   -7,  47,  -30, 0,  0},
            {0,   0,   0,   0,   0,   -30, 41,  0,  0},
            {0,   0,   0,   0,   -5,  0,   0,   27, -2},
            {0,   0,   0,   -9,  0,   0,   0,   -2, 29}
    };
    double b[9] = {-15, 27, -23, 0, -20, 12, -7, 7, 10};
    RES gaussResult = {0, {0}};
    gaussSeidel(A, b, &gaussResult);
    puts("Gauss-Seidel Result:");
    for (int i = 0; i < MATRIX_SIZE; i++) {
        if (i == 0) {
            printf("x=(\n%.15f,\n", gaussResult.x[0]);
        } else {
            printf("%.15f,\n", gaussResult.x[i]);
        }
    }
    printf(")\n");
    printf("iterative steps:%d\n",gaussResult.steps);
    puts("SOR Result:");
    int k = 0;
    int min_steps = INT_MAX;
    for(int n=1;n<=99;n++) {
        RES sorResult = {0, {0}};
        SOR(A, b, n / 50.0, &sorResult);
        for (int i = 0; i < MATRIX_SIZE; i++) {
            if (i == 0) {
                printf("x=(\n%.15f,\n", sorResult.x[0]);
            } else {
                printf("%.15f,\n", sorResult.x[i]);
            }
        }
        printf(")\n");
        printf("iterative steps:%d\n", sorResult.steps);
        if(sorResult.steps<min_steps){
            min_steps = sorResult.steps;
            k = n;
        }
    }
    printf("最佳松弛因子:%.15f，迭代步数:%d\n",k/50.0,min_steps);
    return 0;
}