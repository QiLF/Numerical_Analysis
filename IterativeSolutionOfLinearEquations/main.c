/**
 * HW7
 * Gauss-Seidel And SOR Algorithm for solving linear equations
 * Result:
Gauss-Seidel Result:
x=(
-0.289233755102979,
0.345435763108586,
-0.712811705425009,
-0.220608491772063,
-0.430400413715001,
0.154308774363660,
-0.057822848026590,
0.201053899234003,
0.290228668017912,
)
iterative steps:22
SOR Result:
x=(
-0.289216666700144,
0.345451725021307,
-0.712802175505844,
-0.220601936232584,
-0.430392324193677,
0.154325761560576,
-0.057805622835484,
0.201056337180864,
0.290231784640690,
)
iterative steps:1495
x=(
-0.289225317737771,
0.345443580302478,
-0.712807068954432,
-0.220605301641773,
-0.430396456139888,
0.154317234456570,
-0.057814279528382,
0.201055083600327,
0.290230174095193,
)
iterative steps:800
x=(
-0.289228272736653,
0.345440820329088,
-0.712808716572261,
-0.220606434321505,
-0.430397856338660,
0.154314284140935,
-0.057817277683670,
0.201054661339011,
0.290229634989676,
)
iterative steps:552
x=(
-0.289229683331084,
0.345439507727862,
-0.712809497741910,
-0.220606971200330,
-0.430398522454223,
0.154312865915838,
-0.057818720116452,
0.201054461001510,
0.290229380056049,
)
iterative steps:422
x=(
-0.289230565372262,
0.345438689201408,
-0.712809983791581,
-0.220607305251744,
-0.430398937700863,
0.154311976326996,
-0.057819624693592,
0.201054336399896,
0.290229221795491,
)
iterative steps:342
x=(
-0.289231210484972,
0.345438092232203,
-0.712810337502425,
-0.220607548433990,
-0.430399240199059,
0.154311325588094,
-0.057820285426127,
0.201054245882671,
0.290229106951712,
)
iterative steps:288
x=(
-0.289231606948190,
0.345437725473423,
-0.712810554699430,
-0.220607697678391,
-0.430399426294651,
0.154310923433396,
-0.057820694540631,
0.201054190179040,
0.290229036397266,
)
iterative steps:248
x=(
-0.289231855727007,
0.345437494965276,
-0.712810691311791,
-0.220607791437118,
-0.430399543609635,
0.154310668786923,
-0.057820954668876,
0.201054154974127,
0.290228991893612,
)
iterative steps:217
x=(
-0.289232092489163,
0.345437276334020,
-0.712810820578800,
-0.220607880257220,
-0.430399654529973,
0.154310427991285,
-0.057821199579034,
0.201054121827147,
0.290228949968033,
)
iterative steps:193
x=(
-0.289232324576239,
0.345437062870063,
-0.712810946446564,
-0.220607966866272,
-0.430399762422091,
0.154310193827906,
-0.057821436489654,
0.201054089744301,
0.290228909356574,
)
iterative steps:174
x=(
-0.289232488301809,
0.345436912154285,
-0.712811035341499,
-0.220608027989808,
-0.430399838740091,
0.154310027673944,
-0.057821605000946,
0.201054067019083,
0.290228880627978,
)
iterative steps:158
x=(
-0.289232667846068,
0.345436747805187,
-0.712811131918082,
-0.220608094548794,
-0.430399921480512,
0.154309847889569,
-0.057821785847738,
0.201054042558503,
0.290228849653248,
)
iterative steps:145
x=(
-0.289232738871912,
0.345436681796533,
-0.712811171056833,
-0.220608121328397,
-0.430399955316586,
0.154309773398958,
-0.057821862602732,
0.201054032359226,
0.290228836831351,
)
iterative steps:133
x=(
-0.289232833880681,
0.345436594506950,
-0.712811222445574,
-0.220608156670306,
-0.430399999494528,
0.154309676834824,
-0.057821960404071,
0.201054019234509,
0.290228820257204,
)
iterative steps:123
x=(
-0.289232892366998,
0.345436540269253,
-0.712811254545835,
-0.220608178649602,
-0.430400027246255,
0.154309615676888,
-0.057822023224036,
0.201054010894358,
0.290228809771163,
)
iterative steps:114
x=(
-0.289233027893958,
0.345436417449382,
-0.712811326226138,
-0.220608228248668,
-0.430400088482647,
0.154309482859142,
-0.057822154920962,
0.201053993024881,
0.290228787087928,
)
iterative steps:107
x=(
-0.289233078697133,
0.345436370640594,
-0.712811353807070,
-0.220608247183205,
-0.430400112282910,
0.154309430483508,
-0.057822208231042,
0.201053985930616,
0.290228778153837,
)
iterative steps:100
x=(
-0.289233146708812,
0.345436308733999,
-0.712811390016183,
-0.220608272179548,
-0.430400143337661,
0.154309362699143,
-0.057822275967129,
0.201053976815903,
0.290228766618639,
)
iterative steps:94
x=(
-0.289233156573927,
0.345436298605698,
-0.712811396328362,
-0.220608276320645,
-0.430400149080723,
0.154309349157173,
-0.057822291434281,
0.201053974915298,
0.290228764309113,
)
iterative steps:88
x=(
-0.289233203106610,
0.345436256087262,
-0.712811421240465,
-0.220608293486753,
-0.430400170511118,
0.154309302166355,
-0.057822338644743,
0.201053968597948,
0.290228756330847,
)
iterative steps:83
x=(
-0.289233291532005,
0.345436176842995,
-0.712811467143161,
-0.220608325402593,
-0.430400209587314,
0.154309217701432,
-0.057822420980359,
0.201053957364199,
0.290228742025045,
)
iterative steps:79
x=(
-0.289233258705793,
0.345436204525644,
-0.712811451686011,
-0.220608314325690,
-0.430400196940103,
0.154309243483620,
-0.057822398792217,
0.201053960673388,
0.290228746386924,
)
iterative steps:74
x=(
-0.289233363254884,
0.345436111647244,
-0.712811505198513,
-0.220608351684928,
-0.430400242292882,
0.154309146035041,
-0.057822492413884,
0.201053947790301,
0.290228729919728,
)
iterative steps:71
x=(
-0.289233357102836,
0.345436115970253,
-0.712811503079636,
-0.220608349987876,
-0.430400240846632,
0.154309148077733,
-0.057822492385523,
0.201053947986902,
0.290228730270569,
)
iterative steps:67
x=(
-0.289233408149750,
0.345436070410125,
-0.712811529387151,
-0.220608368313452,
-0.430400263234044,
0.154309099684911,
-0.057822539238956,
0.201053941589115,
0.290228722116533,
)
iterative steps:64
x=(
-0.289233437719867,
0.345436043736610,
-0.712811544873088,
-0.220608379048462,
-0.430400276510393,
0.154309070690210,
-0.057822567765107,
0.201053937744631,
0.290228717242398,
)
iterative steps:61
x=(
-0.289233449140604,
0.345436032903664,
-0.712811551322265,
-0.220608383422982,
-0.430400282207913,
0.154309057749270,
-0.057822581308369,
0.201053936002479,
0.290228715077166,
)
iterative steps:58
x=(
-0.289233443203270,
0.345436037087810,
-0.712811549247095,
-0.220608381773241,
-0.430400280795950,
0.154309059754909,
-0.057822581117665,
0.201053936207981,
0.290228715432362,
)
iterative steps:55
x=(
-0.289233502535451,
0.345435985060867,
-0.712811578974437,
-0.220608402655995,
-0.430400305854625,
0.154309006301252,
-0.057822631346316,
0.201053929219265,
0.290228706454680,
)
iterative steps:53
x=(
-0.289233468163200,
0.345436013689417,
-0.712811563070971,
-0.220608391205727,
-0.430400292955233,
0.154309032331196,
-0.057822609316246,
0.201053932544320,
0.290228710858689,
)
iterative steps:50
x=(
-0.289233503135465,
0.345435982832045,
-0.712811580749938,
-0.220608403592573,
-0.430400307935328,
0.154309000159600,
-0.057822639818279,
0.201053928335285,
0.290228705469216,
)
iterative steps:48
x=(
-0.289233526088405,
0.345435962391192,
-0.712811592509930,
-0.220608411800535,
-0.430400317975412,
0.154308978388244,
-0.057822660733036,
0.201053925482985,
0.290228701834079,
)
iterative steps:46
x=(
-0.289233538821110,
0.345435950735636,
-0.712811599299260,
-0.220608416486399,
-0.430400323888544,
0.154308965246075,
-0.057822673799846,
0.201053923751643,
0.290228699653860,
)
iterative steps:44
x=(
-0.289233542123272,
0.345435947106198,
-0.712811601570682,
-0.220608417956885,
-0.430400326077809,
0.154308959815602,
-0.057822679975671,
0.201053923017685,
0.290228698774877,
)
iterative steps:42
x=(
-0.289233612591589,
0.345435886910986,
-0.712811635466497,
-0.220608442065975,
-0.430400354186082,
0.154308901228551,
-0.057822732499221,
0.201053915465942,
0.290228688946763,
)
iterative steps:41
x=(
-0.289233603499970,
0.345435893885615,
-0.712811631751038,
-0.220608439286818,
-0.430400351418672,
0.154308906131551,
-0.057822729333707,
0.201053916070905,
0.290228689808309,
)
iterative steps:39
x=(
-0.289233585372769,
0.345435908326938,
-0.712811623893867,
-0.220608433522135,
-0.430400345321822,
0.154308917702377,
-0.057822720551086,
0.201053917528655,
0.290228691802367,
)
iterative steps:37
x=(
-0.289233635864152,
0.345435865535139,
-0.712811647884325,
-0.220608450652515,
-0.430400365117125,
0.154308876747731,
-0.057822756705441,
0.201053912273231,
0.290228684934089,
)
iterative steps:36
x=(
-0.289233607277849,
0.345435888576264,
-0.712811635262175,
-0.220608441449791,
-0.430400355212529,
0.154308895902065,
-0.057822741565461,
0.201053914701479,
0.290228688219811,
)
iterative steps:34
x=(
-0.289233647496087,
0.345435854650922,
-0.712811654230995,
-0.220608455028202,
-0.430400370819697,
0.154308863761880,
-0.057822769660504,
0.201053910588595,
0.290228682830540,
)
iterative steps:33
x=(
-0.289233678842179,
0.345435828290861,
-0.712811668944825,
-0.220608465578596,
-0.430400382907026,
0.154308838938250,
-0.057822791226741,
0.201053907418297,
0.290228678669943,
)
iterative steps:32
x=(
-0.289233639956491,
0.345435859505475,
-0.712811651857586,
-0.220608453116014,
-0.430400369581738,
0.154308864559819,
-0.057822771074699,
0.201053910670723,
0.290228683081096,
)
iterative steps:30
x=(
-0.289233667011386,
0.345435836801894,
-0.712811664508693,
-0.220608462204404,
-0.430400379972081,
0.154308843269463,
-0.057822789447748,
0.201053907957906,
0.290228679515488,
)
iterative steps:29
x=(
-0.289233688661618,
0.345435818669498,
-0.712811674599151,
-0.220608469464820,
-0.430400388256996,
0.154308826324418,
-0.057822803995936,
0.201053905802745,
0.290228676679592,
)
iterative steps:28
x=(
-0.289233706076458,
0.345435804106777,
-0.712811682693247,
-0.220608475298334,
-0.430400394904747,
0.154308812748543,
-0.057822815594695,
0.201053904079268,
0.290228674409420,
)
iterative steps:27
x=(
-0.289233720156327,
0.345435792344408,
-0.712811689223730,
-0.220608480013121,
-0.430400400274450,
0.154308801794307,
-0.057822824910943,
0.201053902691266,
0.290228672579606,
)
iterative steps:26
x=(
-0.289233731600562,
0.345435782786342,
-0.712811694525311,
-0.220608483848078,
-0.430400404643887,
0.154308792884622,
-0.057822832456474,
0.201053901564660,
0.290228671093501,
)
iterative steps:25
x=(
-0.289233740958930,
0.345435774965270,
-0.712811698859922,
-0.220608486990695,
-0.430400408230428,
0.154308785569262,
-0.057822838627643,
0.201053900641805,
0.290228669875756,
)
iterative steps:24
x=(
-0.289233748671803,
0.345435768508176,
-0.712811702436185,
-0.220608489590874,
-0.430400411207056,
0.154308779491747,
-0.057822843735139,
0.201053899877170,
0.290228668866695,
)
iterative steps:23
x=(
-0.289233755102979,
0.345435763108586,
-0.712811705425009,
-0.220608491772063,
-0.430400413715001,
0.154308774363660,
-0.057822848026590,
0.201053899234003,
0.290228668017912,
)
iterative steps:22
x=(
-0.289233760568647,
0.345435758502691,
-0.712811707972909,
-0.220608493640821,
-0.430400415874195,
0.154308769944129,
-0.057822851703982,
0.201053898681649,
0.290228667288693,
)
iterative steps:21
x=(
-0.289233765365953,
0.345435754446669,
-0.712811710214523,
-0.220608495295837,
-0.430400417792467,
0.154308766022825,
-0.057822854937192,
0.201053898193312,
0.290228666642951,
)
iterative steps:20
x=(
-0.289233769805065,
0.345435750692516,
-0.712811712285780,
-0.220608496837382,
-0.430400419574231,
0.154308762405535,
-0.057822857874262,
0.201053897744111,
0.290228666046419,
)
iterative steps:19
x=(
-0.289233774249089,
0.345435746959821,
-0.712811714339079,
-0.220608498377996,
-0.430400421328871,
0.154308758902688,
-0.057822860647913,
0.201053897309406,
0.290228665464070,
)
iterative steps:18
x=(
-0.289233779165156,
0.345435742902489,
-0.712811716560917,
-0.220608500054224,
-0.430400423177576,
0.154308755324334,
-0.057822863375491,
0.201053896863775,
0.290228664858189,
)
iterative steps:17
x=(
-0.289233785181358,
0.345435738077593,
-0.712811719187912,
-0.220608502035153,
-0.430400425252674,
0.154308751493661,
-0.057822866144189,
0.201053896382018,
0.290228664188988,
)
iterative steps:16
x=(
-0.289233793113505,
0.345435731955781,
-0.712811722500459,
-0.220608504508190,
-0.430400427668551,
0.154308747314733,
-0.057822868960668,
0.201053895846182,
0.290228663424505,
)
iterative steps:15
x=(
-0.289233803705506,
0.345435724104064,
-0.712811726671069,
-0.220608507569166,
-0.430400430387344,
0.154308742995590,
-0.057822871615193,
0.201053895269986,
0.290228662568463,
)
iterative steps:14
x=(
-0.289233816150028,
0.345435715503508,
-0.712811731116577,
-0.220608510381987,
-0.430400432753957,
0.154308739696567,
-0.057822873368742,
0.201053895143637,
0.290228661998303,
)
iterative steps:13
x=(
-0.289233810519857,
0.345435719483424,
-0.712811728134601,
-0.220608508721017,
-0.430400432018911,
0.154308740269648,
-0.057822873065916,
0.201053896137633,
0.290228662241767,
)
iterative steps:13
x=(
-0.289233814439655,
0.345435716367083,
-0.712811731612614,
-0.220608511366834,
-0.430400433063958,
0.154308739642543,
-0.057822873397142,
0.201053893926629,
0.290228661582457,
)
iterative steps:14
x=(
-0.289233817879685,
0.345435713863961,
-0.712811731815604,
-0.220608510496468,
-0.430400432656087,
0.154308739897804,
-0.057822873244709,
0.201053895451993,
0.290228662065320,
)
iterative steps:15
x=(
-0.289233820989542,
0.345435712957950,
-0.712811730453617,
-0.220608508922562,
-0.430400431737684,
0.154308740131238,
-0.057822873191043,
0.201053896935735,
0.290228662437019,
)
iterative steps:15
x=(
-0.289233824464834,
0.345435716767311,
-0.712811723272562,
-0.220608504122812,
-0.430400429756727,
0.154308739529403,
-0.057822873589887,
0.201053900689008,
0.290228662694786,
)
iterative steps:15
x=(
-0.289233804091621,
0.345435727322254,
-0.712811728409630,
-0.220608512572656,
-0.430400434646484,
0.154308739380498,
-0.057822873373753,
0.201053889966120,
0.290228660884678,
)
iterative steps:16
x=(
-0.289233781304900,
0.345435735967105,
-0.712811733972097,
-0.220608520538919,
-0.430400439715379,
0.154308740159184,
-0.057822872734157,
0.201053881819119,
0.290228659812761,
)
iterative steps:16
x=(
-0.289233830081791,
0.345435684362709,
-0.712811747537977,
-0.220608512024711,
-0.430400430528848,
0.154308740701542,
-0.057822873211098,
0.201053905882634,
0.290228663036370,
)
iterative steps:17
x=(
-0.289233837581149,
0.345435727669988,
-0.712811713236542,
-0.220608502699917,
-0.430400427912599,
0.154308739891213,
-0.057822872948797,
0.201053885927847,
0.290228663070280,
)
iterative steps:18
x=(
-0.289233776217286,
0.345435736472167,
-0.712811734158578,
-0.220608514658203,
-0.430400440963066,
0.154308739054401,
-0.057822874349274,
0.201053902267310,
0.290228659981805,
)
iterative steps:19
x=(
-0.289233830879704,
0.345435721023453,
-0.712811726395890,
-0.220608504228864,
-0.430400431087966,
0.154308740766172,
-0.057822872493805,
0.201053898129765,
0.290228665406410,
)
iterative steps:21
x=(
-0.289233788574328,
0.345435727009484,
-0.712811726145156,
-0.220608514407327,
-0.430400435109668,
0.154308739925590,
-0.057822873982093,
0.201053891169952,
0.290228656676373,
)
iterative steps:22
x=(
-0.289233745276569,
0.345435733894186,
-0.712811728053117,
-0.220608526052060,
-0.430400440794005,
0.154308738749390,
-0.057822876104516,
0.201053883903887,
0.290228647932285,
)
iterative steps:22
x=(
-0.289233823111242,
0.345435725666626,
-0.712811708898830,
-0.220608500755536,
-0.430400426216635,
0.154308742371292,
-0.057822869986154,
0.201053893237037,
0.290228658983547,
)
iterative steps:24
x=(
-0.289233782492481,
0.345435743386448,
-0.712811738983431,
-0.220608518565857,
-0.430400445056966,
0.154308741539546,
-0.057822875854603,
0.201053893794234,
0.290228662814140,
)
iterative steps:25
x=(
-0.289233854117857,
0.345435723281638,
-0.712811720643637,
-0.220608498668392,
-0.430400429737170,
0.154308741115091,
-0.057822870068643,
0.201053893434674,
0.290228669570033,
)
iterative steps:27
x=(
-0.289233829189710,
0.345435689116729,
-0.712811754452799,
-0.220608518146221,
-0.430400432744997,
0.154308736951929,
-0.057822876282515,
0.201053892398833,
0.290228665625032,
)
iterative steps:29
x=(
-0.289233846004706,
0.345435721888428,
-0.712811700553821,
-0.220608490081825,
-0.430400421211097,
0.154308739730002,
-0.057822868745531,
0.201053902468089,
0.290228664482038,
)
iterative steps:30
x=(
-0.289233853840454,
0.345435707619519,
-0.712811724833036,
-0.220608499763021,
-0.430400424352460,
0.154308739227380,
-0.057822871194494,
0.201053892070889,
0.290228666608242,
)
iterative steps:33
x=(
-0.289233805939347,
0.345435688608534,
-0.712811761045154,
-0.220608527669320,
-0.430400436576931,
0.154308736893439,
-0.057822877383332,
0.201053891141240,
0.290228657702990,
)
iterative steps:35
x=(
-0.289233791740758,
0.345435703622063,
-0.712811751231350,
-0.220608525867222,
-0.430400440579334,
0.154308737153794,
-0.057822878161771,
0.201053895716375,
0.290228660640983,
)
iterative steps:38
x=(
-0.289233781307305,
0.345435715891702,
-0.712811747960448,
-0.220608526463656,
-0.430400442623736,
0.154308738559927,
-0.057822878504550,
0.201053893781188,
0.290228653039295,
)
iterative steps:41
x=(
-0.289233766130192,
0.345435732630411,
-0.712811740617087,
-0.220608527589597,
-0.430400448190126,
0.154308741246880,
-0.057822878402409,
0.201053889749083,
0.290228654099075,
)
iterative steps:44
x=(
-0.289233828306690,
0.345435665034711,
-0.712811764907381,
-0.220608524560553,
-0.430400428539695,
0.154308732719257,
-0.057822879086607,
0.201053896109910,
0.290228665119773,
)
iterative steps:48
x=(
-0.289233878402580,
0.345435696520854,
-0.712811713263645,
-0.220608486332810,
-0.430400409978322,
0.154308739051331,
-0.057822865045428,
0.201053898307654,
0.290228674417425,
)
iterative steps:52
x=(
-0.289233824457561,
0.345435751092001,
-0.712811698451309,
-0.220608492089352,
-0.430400429351456,
0.154308746218670,
-0.057822865441442,
0.201053892684562,
0.290228663330713,
)
iterative steps:59
x=(
-0.289233865249805,
0.345435716940035,
-0.712811704865846,
-0.220608484601247,
-0.430400414208736,
0.154308741829441,
-0.057822863081209,
0.201053897159866,
0.290228672472891,
)
iterative steps:65
x=(
-0.289233758034308,
0.345435720235865,
-0.712811758066637,
-0.220608539431489,
-0.430400455277045,
0.154308738202276,
-0.057822885202810,
0.201053891411456,
0.290228648127277,
)
iterative steps:73
x=(
-0.289233879162930,
0.345435676526281,
-0.712811730036557,
-0.220608493299846,
-0.430400408103224,
0.154308735086408,
-0.057822866630160,
0.201053901200066,
0.290228677497290,
)
iterative steps:84
x=(
-0.289233892412523,
0.345435680744368,
-0.712811719050871,
-0.220608483837309,
-0.430400401676234,
0.154308736405117,
-0.057822861876458,
0.201053901985592,
0.290228681301287,
)
iterative steps:97
x=(
-0.289233755629110,
0.345435744093310,
-0.712811740478891,
-0.220608531858554,
-0.430400458011271,
0.154308742715925,
-0.057822882825689,
0.201053888899273,
0.290228645995632,
)
iterative steps:118
x=(
-0.289233741399446,
0.345435731734636,
-0.712811759343989,
-0.220608545891248,
-0.430400465681110,
0.154308739334610,
-0.057822890490866,
0.201053888538236,
0.290228641737001,
)
iterative steps:144
x=(
-0.289233873617927,
0.345435714051061,
-0.712811699805553,
-0.220608478059735,
-0.430400405997502,
0.154308742685857,
-0.057822856498310,
0.201053899108447,
0.290228677874472,
)
iterative steps:191
x=(
-0.289233881972361,
0.345435688927189,
-0.712811716046095,
-0.220608484107330,
-0.430400402275558,
0.154308737505851,
-0.057822859519323,
0.201053901789938,
0.290228680849454,
)
iterative steps:275
x=(
-0.289233895264796,
0.345435678219965,
-0.712811717042696,
-0.220608480668004,
-0.430400395352322,
0.154308735750393,
-0.057822857179918,
0.201053903918613,
0.290228685337079,
)
iterative steps:479
x=(
-0.289233736245558,
0.345435740459639,
-0.712811757092262,
-0.220608547292135,
-0.430400472027587,
0.154308740721119,
-0.057822894315986,
0.201053886364687,
0.290228637626406,
)
iterative steps:1893
x=(
-1.#IND00000000000,
-1.#IND00000000000,
-1.#IND00000000000,
-1.#IND00000000000,
-1.#IND00000000000,
-1.#IND00000000000,
-1.#IND00000000000,
-1.#IND00000000000,
-1.#IND00000000000,
)
iterative steps:45054
x=(
-1.#IND00000000000,
-1.#IND00000000000,
-1.#IND00000000000,
-1.#IND00000000000,
-1.#IND00000000000,
-1.#IND00000000000,
-1.#IND00000000000,
-1.#IND00000000000,
-1.#IND00000000000,
)
iterative steps:18077
x=(
-1.#IND00000000000,
-1.#IND00000000000,
-1.#IND00000000000,
-1.#IND00000000000,
-1.#IND00000000000,
-1.#IND00000000000,
-1.#IND00000000000,
-1.#IND00000000000,
-1.#IND00000000000,
)
iterative steps:11393
x=(
-1.#IND00000000000,
-1.#IND00000000000,
-1.#IND00000000000,
-1.#IND00000000000,
-1.#IND00000000000,
-1.#IND00000000000,
-1.#IND00000000000,
-1.#IND00000000000,
-1.#IND00000000000,
)
iterative steps:8363
最佳松弛因子:1.180000000000000，迭代步数:13

Process finished with exit code 0

 */
#include <stdio.h>
#include <math.h>
#include <limits.h>

#define MATRIX_SIZE 9
#define ERROR_THRESHOLD 1E-7


typedef struct {
    int steps;
    double x[MATRIX_SIZE];
} RES;

/**
 * @brief Gauss-Seidel Algorithm for solving linear equations Ax = b with error ERROR_THRESHOLD
 * @param A input: Coefficient matrix
 * @param b input: Constant terms
 * @param x output: The unknowns
 */
void gaussSeidel(double A[][MATRIX_SIZE], double b[MATRIX_SIZE], RES *result) {
    int flag = 0; // 指示|x-x1|的无穷范数是否小于误差限
    double x1[MATRIX_SIZE] = {0};
    result->steps = 0;
    while (flag == 0) {
        result->steps++;
        for (int i = 0; i < MATRIX_SIZE; i++) {
            x1[i] = result->x[i];
        }
        for (int i = 0; i < MATRIX_SIZE; i++) {
            double s = 0;
            for (int j = 0; j < MATRIX_SIZE; j++) {
                s = s + A[i][j] * result->x[j];
            }
            result->x[i] = (b[i] - s + A[i][i] * result->x[i]) / A[i][i];
        }
        // 检验迭代是否结束
        flag = 1;
        for (int i = 0; i < MATRIX_SIZE; i++) {
            if (fabs(result->x[i] - x1[i]) > ERROR_THRESHOLD) {
                flag = 0;
            }
        }
    }
}

/**
 * @brief SOR Algorithm for solving linear equations Ax=b with error ERROR_THRESHOLD
 * @param A input: Coefficient matrix
 * @param b input: Constant terms
 * @param w input: relaxation factor
 * @param x output: The unknowns
 */
void SOR(double A[][MATRIX_SIZE], double b[MATRIX_SIZE], double w, RES *result) {
    int flag = 0; // 指示|x-x1|的无穷范数是否小于误差限
    double x1[MATRIX_SIZE] = {0};
    result->steps = 0;
    while (flag == 0) {
        result->steps++;
        for (int i = 0; i < MATRIX_SIZE; i++) {
            x1[i] = result->x[i];
        }
        for (int i = 0; i < MATRIX_SIZE; i++) {
            double s = 0;
            for (int j = 0; j < MATRIX_SIZE; j++) {
                s = s + A[i][j] * result->x[j] ;
            }
            result->x[i] = x1[i] * (1-w) + w * (b[i] - s + A[i][i] * result->x[i]) / A[i][i];
        }
        // 检验迭代是否结束
        flag = 1;
        for (int i = 0; i < MATRIX_SIZE; i++) {
            if (fabs(result->x[i] - x1[i]) > ERROR_THRESHOLD) {
                flag = 0;
            }
        }
    }
}

int main() {
    double A[9][9] = {
            {31,  -13, 0,   0,   0,   -10, 0,   0,  0},
            {-13, 35,  -9,  0,   -11, 0,   0,   0,  0},
            {0,   -9,  31,  -10, 0,   0,   0,   0,  0},
            {0,   0,   -10, 79,  -30, 0,   0,   0,  -9},
            {0,   0,   0,   -30, 57,  -7,  0,   -5, 0},
            {0,   0,   0,   0,   -7,  47,  -30, 0,  0},
            {0,   0,   0,   0,   0,   -30, 41,  0,  0},
            {0,   0,   0,   0,   -5,  0,   0,   27, -2},
            {0,   0,   0,   -9,  0,   0,   0,   -2, 29}
    };
    double b[9] = {-15, 27, -23, 0, -20, 12, -7, 7, 10};
    RES gaussResult = {0, {0, 0, 0, 0, 0, 0, 0, 0, 0}};
    gaussSeidel(A, b, &gaussResult);
    puts("Gauss-Seidel Result:");
    for (int i = 0; i < MATRIX_SIZE; i++) {
        if (i == 0) {
            printf("x=(\n%.15f,\n", gaussResult.x[0]);
        } else {
            printf("%.15f,\n", gaussResult.x[i]);
        }
    }
    printf(")\n");
    printf("iterative steps:%d\n", gaussResult.steps);
    puts("SOR Result:");
    int k = 0;
    int min_steps = INT_MAX;
    for (int n = 1; n <= 99; n++) {
        RES sorResult = {0, {0, 0, 0, 0, 0, 0, 0, 0, 0}};
        SOR(A, b, n / 50.0, &sorResult);
        printf("");
        for (int i = 0; i < MATRIX_SIZE; i++) {
            if (i == 0) {
                printf("x=(\n%.15f,\n", sorResult.x[0]);
            } else {
                printf("%.15f,\n", sorResult.x[i]);
            }
        }
        printf(")\n");
        printf("iterative steps:%d\n", sorResult.steps);
        if (sorResult.steps < min_steps) {
            min_steps = sorResult.steps;
            k = n;
        }
    }
    printf("最佳松弛因子:%.15f，迭代步数:%d\n", k / 50.0, min_steps);
    return 0;
}