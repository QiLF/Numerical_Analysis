/**
 * HW7
 * Gauss-Seidel And SOR Algorithm for solving linear equations
 * Result:
Gauss-Seidel Result:
x=(
-0.289233755102979,
0.345435763108586,
-0.712811705425009,
-0.220608491772063,
-0.430400413715001,
0.154308774363660,
-0.057822848026590,
0.201053899234003,
0.290228668017912,
)
iterative steps:22
SOR Result:
x=(
-0.289233748494261,
0.345435716078324,
-0.712811695351984,
-0.220608510438237,
-0.430400401756167,
0.154308740677326,
-0.057822803601086,
0.201053894959706,
0.290228673295598,
)
iterative steps:44
x=(
-0.289233796877334,
0.345435773582398,
-0.712811720604183,
-0.220608487338349,
-0.430400423543507,
0.154308804554693,
-0.057822851641358,
0.201053903344632,
0.290228665322881,
)
iterative steps:43
x=(
-0.289233766359973,
0.345435801023361,
-0.712811704309484,
-0.220608476312316,
-0.430400409394801,
0.154308834949487,
-0.057822819389037,
0.201053907337465,
0.290228670566712,
)
iterative steps:41
x=(
-0.289233710710653,
0.345435782941609,
-0.712811675859102,
-0.220608483554597,
-0.430400385012089,
0.154308816296591,
-0.057822767440866,
0.201053904943282,
0.290228679384832,
)
iterative steps:40
x=(
-0.289233716045004,
0.345435826661553,
-0.712811678015705,
-0.220608466011725,
-0.430400386698531,
0.154308863187249,
-0.057822769326100,
0.201053911044069,
0.290228678876509,
)
iterative steps:39
x=(
-0.289233667981613,
0.345435834406399,
-0.712811653618389,
-0.220608462885173,
-0.430400365857595,
0.154308873087209,
-0.057822725499695,
0.201053912385849,
0.290228686385808,
)
iterative steps:38
x=(
-0.289233647353974,
0.345435879336588,
-0.712811642402471,
-0.220608444853490,
-0.430400356043485,
0.154308921115737,
-0.057822702622515,
0.201053918639672,
0.290228690051684,
)
iterative steps:37
x=(
-0.289233664607023,
0.345435857559365,
-0.712811651819092,
-0.220608453612169,
-0.430400364269159,
0.154308896665436,
-0.057822721931951,
0.201053915409773,
0.290228686967236,
)
iterative steps:37
x=(
-0.289233618458799,
0.345435888993469,
-0.712811628304398,
-0.220608440986546,
-0.430400344168832,
0.154308931553881,
-0.057822679439638,
0.201053919984998,
0.290228694227142,
)
iterative steps:36
x=(
-0.289233643085647,
0.345435868826925,
-0.712811641351010,
-0.220608449100929,
-0.430400355460456,
0.154308908504384,
-0.057822704842032,
0.201053916929392,
0.290228690058091,
)
iterative steps:36
x=(
-0.289233599093656,
0.345435911600153,
-0.712811618711831,
-0.220608431934493,
-0.430400336014232,
0.154308954383095,
-0.057822663093830,
0.201053922908482,
0.290228697115520,
)
iterative steps:35
x=(
-0.289233625054844,
0.345435887144859,
-0.712811632506497,
-0.220608441767634,
-0.430400347973442,
0.154308926936096,
-0.057822690102252,
0.201053919286008,
0.290228692695134,
)
iterative steps:35
x=(
-0.289233648573132,
0.345435865413521,
-0.712811644945990,
-0.220608450503519,
-0.430400358744083,
0.154308902601334,
-0.057822714265991,
0.201053916078146,
0.290228688724246,
)
iterative steps:35
x=(
-0.289233601854360,
0.345435906033977,
-0.712811621297037,
-0.220608434205653,
-0.430400338564791,
0.154308945986345,
-0.057822672124179,
0.201053921719159,
0.290228695982114,
)
iterative steps:34
x=(
-0.289233628963016,
0.345435881722017,
-0.712811635519221,
-0.220608443975927,
-0.430400350846009,
0.154308918879423,
-0.057822699329224,
0.201053918152633,
0.290228691474376,
)
iterative steps:34
x=(
-0.289233653150518,
0.345435860007366,
-0.712811648166096,
-0.220608452700162,
-0.430400361757786,
0.154308894773103,
-0.057822723379461,
0.201053914985812,
0.290228687477251,
)
iterative steps:34
x=(
-0.289233674685362,
0.345435840684721,
-0.712811659386004,
-0.220608460461449,
-0.430400371429414,
0.154308873414640,
-0.057822744582057,
0.201053912184254,
0.290228683941791,
)
iterative steps:34
x=(
-0.289233634364881,
0.345435876026730,
-0.712811639246272,
-0.220608446290104,
-0.430400354324026,
0.154308910360994,
-0.057822709694947,
0.201053916964710,
0.290228690045614,
)
iterative steps:33
x=(
-0.289233658817291,
0.345435854122991,
-0.712811651905251,
-0.220608455085019,
-0.430400365215270,
0.154308886353749,
-0.057822733319988,
0.201053913823134,
0.290228686078989,
)
iterative steps:33
x=(
-0.289233680498837,
0.345435834754038,
-0.712811663085311,
-0.220608462860392,
-0.430400374823059,
0.154308865219694,
-0.057822754032394,
0.201053911061788,
0.290228682587873,
)
iterative steps:33
x=(
-0.289233640622024,
0.345435869395514,
-0.712811643399980,
-0.220608448974761,
-0.430400358185127,
0.154308900849511,
-0.057822720831478,
0.201053915656273,
0.290228688484567,
)
iterative steps:32
x=(
-0.289233665317239,
0.345435847438517,
-0.712811656043999,
-0.220608457786282,
-0.430400369025256,
0.154308877104216,
-0.057822743919728,
0.201053912561127,
0.290228684561669,
)
iterative steps:32
x=(
-0.289233687083571,
0.345435828134762,
-0.712811667141824,
-0.220608465531409,
-0.430400378527493,
0.154308856333311,
-0.057822764021616,
0.201053909857928,
0.290228681131360,
)
iterative steps:32
x=(
-0.289233647966858,
0.345435861855270,
-0.712811648069001,
-0.220608452019373,
-0.430400362495973,
0.154308890378437,
-0.057822732787678,
0.201053914233371,
0.290228686772249,
)
iterative steps:31
x=(
-0.289233672786848,
0.345435839944960,
-0.712811660628716,
-0.220608460807737,
-0.430400373221035,
0.154308867038310,
-0.057822755176176,
0.201053911203143,
0.290228682917313,
)
iterative steps:31
x=(
-0.289233694521516,
0.345435820812082,
-0.712811671577915,
-0.220608468480616,
-0.430400382556781,
0.154308846771407,
-0.057822774517763,
0.201053908576083,
0.290228679570566,
)
iterative steps:31
x=(
-0.289233656483676,
0.345435853319672,
-0.712811653275819,
-0.220608455458462,
-0.430400367272904,
0.154308878913431,
-0.057822745529013,
0.201053912693490,
0.290228684906737,
)
iterative steps:30
x=(
-0.289233681294336,
0.345435831590116,
-0.712811665673602,
-0.220608464170414,
-0.430400377810642,
0.154308856153756,
-0.057822767038308,
0.201053909750505,
0.290228681146799,
)
iterative steps:30
x=(
-0.289233702859666,
0.345435812760133,
-0.712811676397963,
-0.220608471718627,
-0.430400386909944,
0.154308836556373,
-0.057822785454811,
0.201053907220463,
0.290228677909293,
)
iterative steps:30
x=(
-0.289233666279773,
0.345435843728723,
-0.712811659047077,
-0.220608459316500,
-0.430400372532059,
0.154308866454758,
-0.057822758998180,
0.201053911038627,
0.290228682887186,
)
iterative steps:29
x=(
-0.289233690910412,
0.345435822341503,
-0.712811671188968,
-0.220608467887849,
-0.430400382796067,
0.154308844478659,
-0.057822779426863,
0.201053908208417,
0.290228679253839,
)
iterative steps:29
x=(
-0.289233712136404,
0.345435803971604,
-0.712811681598382,
-0.220608475248962,
-0.430400391577045,
0.154308825739860,
-0.057822796737035,
0.201053905798931,
0.290228676154975,
)
iterative steps:29
x=(
-0.289233677450251,
0.345435833033957,
-0.712811665398272,
-0.220608463613716,
-0.430400378277630,
0.154308853034331,
-0.057822773096741,
0.201053909274769,
0.290228680717705,
)
iterative steps:28
x=(
-0.289233701688966,
0.345435812184770,
-0.712811677172595,
-0.220608471966689,
-0.430400388166157,
0.154308832076209,
-0.057822792222440,
0.201053906586407,
0.290228677247321,
)
iterative steps:28
x=(
-0.289233662287835,
0.345435844954865,
-0.712811658968387,
-0.220608458850282,
-0.430400373331893,
0.154308862215813,
-0.057822766523907,
0.201053910419057,
0.290228682304457,
)
iterative steps:27
x=(
-0.289233690072722,
0.345435821211148,
-0.712811672330211,
-0.220608468361199,
-0.430400384497479,
0.154308838730786,
-0.057822787674320,
0.201053907413633,
0.290228678408911,
)
iterative steps:27
x=(
-0.289233713657955,
0.345435801134866,
-0.712811683605058,
-0.220608476402343,
-0.430400393891639,
0.154308819057878,
-0.057822805255693,
0.201053904899821,
0.290228675142972,
)
iterative steps:27
x=(
-0.289233677200447,
0.345435831081836,
-0.712811667060216,
-0.220608464421748,
-0.430400380588464,
0.154308845615954,
-0.057822783211026,
0.201053908270522,
0.290228679630306,
)
iterative steps:26
x=(
-0.289233704191997,
0.345435808273521,
-0.712811679821512,
-0.220608473555701,
-0.430400391155483,
0.154308823687106,
-0.057822802514216,
0.201053905474620,
0.290228675980455,
)
iterative steps:26
x=(
-0.289233726803331,
0.345435789249781,
-0.712811690442419,
-0.220608481173519,
-0.430400399917823,
0.154308805599591,
-0.057822818295597,
0.201053903171588,
0.290228672965672,
)
iterative steps:26
x=(
-0.289233694015380,
0.345435815803975,
-0.712811675855750,
-0.220608470558775,
-0.430400388388855,
0.154308828125383,
-0.057822800179018,
0.201053906027919,
0.290228676809086,
)
iterative steps:25
x=(
-0.289233719797736,
0.345435794291592,
-0.712811687818377,
-0.220608479171720,
-0.430400398180974,
0.154308808134414,
-0.057822817316353,
0.201053903487400,
0.290228673464368,
)
iterative steps:25
x=(
-0.289233741045440,
0.345435776650305,
-0.712811697606205,
-0.220608486234217,
-0.430400406154611,
0.154308791962737,
-0.057822831036313,
0.201053901434461,
0.290228670752470,
)
iterative steps:25
x=(
-0.289233712730401,
0.345435799207549,
-0.712811685288760,
-0.220608477230682,
-0.430400396639913,
0.154308810053870,
-0.057822817031486,
0.201053903730330,
0.290228673882766,
)
iterative steps:24
x=(
-0.289233736788940,
0.345435779422937,
-0.712811696219535,
-0.220608485149298,
-0.430400405453339,
0.154308792424324,
-0.057822831677148,
0.201053901495367,
0.290228670909704,
)
iterative steps:24
x=(
-0.289233705964940,
0.345435803674206,
-0.712811683030200,
-0.220608475486745,
-0.430400395465339,
0.154308810996537,
-0.057822817725293,
0.201053903857363,
0.290228674164343,
)
iterative steps:23
x=(
-0.289233733214177,
0.345435781503175,
-0.712811695225862,
-0.220608484357093,
-0.430400405175586,
0.154308791886648,
-0.057822833224620,
0.201053901436618,
0.290228670917919,
)
iterative steps:23
x=(
-0.289233754914237,
0.345435763959921,
-0.712811704852430,
-0.220608491373768,
-0.430400412778302,
0.154308777074442,
-0.057822845066207,
0.201053899560492,
0.290228668389417,
)
iterative steps:23
x=(
-0.289233730952307,
0.345435782382167,
-0.712811694897653,
-0.220608484070611,
-0.430400405550574,
0.154308789925963,
-0.057822835958465,
0.201053901206881,
0.290228670705133,
)
iterative steps:22
x=(
-0.289233755102979,
0.345435763108586,
-0.712811705425009,
-0.220608491772063,
-0.430400413715001,
0.154308774363660,
-0.057822848026590,
0.201053899234003,
0.290228668017912,
)
iterative steps:22
x=(
-0.289233731012332,
0.345435781276560,
-0.712811695652139,
-0.220608484617209,
-0.430400406904294,
0.154308785988864,
-0.057822840200339,
0.201053900737900,
0.290228670171676,
)
iterative steps:21
x=(
-0.289233757659090,
0.345435760330208,
-0.712811707038724,
-0.220608492971940,
-0.430400415523947,
0.154308770006079,
-0.057822852145461,
0.201053898705951,
0.290228667367621,
)
iterative steps:21
x=(
-0.289233735003674,
0.345435776985788,
-0.712811698126733,
-0.220608486495091,
-0.430400409686379,
0.154308779400483,
-0.057822846265683,
0.201053899943449,
0.290228669184293,
)
iterative steps:20
x=(
-0.289233763913246,
0.345435754676104,
-0.712811710194458,
-0.220608495360621,
-0.430400418513750,
0.154308763620779,
-0.057822857519462,
0.201053897924571,
0.290228666351112,
)
iterative steps:20
x=(
-0.289233745472264,
0.345435767701889,
-0.712811703279507,
-0.220608490438898,
-0.430400414467291,
0.154308769483628,
-0.057822854311262,
0.201053898729088,
0.290228667581460,
)
iterative steps:19
x=(
-0.289233775768456,
0.345435744884521,
-0.712811715555644,
-0.220608499429675,
-0.430400422978084,
0.154308755051573,
-0.057822863963152,
0.201053896857701,
0.290228664893897,
)
iterative steps:19
x=(
-0.289233766325349,
0.345435750865741,
-0.712811712459699,
-0.220608497420522,
-0.430400421781128,
0.154308756056114,
-0.057822863899967,
0.201053897042340,
0.290228665229856,
)
iterative steps:18
x=(
-0.289233760425488,
0.345435753546827,
-0.712811711220979,
-0.220608496984943,
-0.430400422266164,
0.154308754104202,
-0.057822865726180,
0.201053896860765,
0.290228665037983,
)
iterative steps:17
x=(
-0.289233803053103,
0.345435723628691,
-0.712811727100410,
-0.220608508176108,
-0.430400431282410,
0.154308741258209,
-0.057822872758025,
0.201053895075355,
0.290228662298133,
)
iterative steps:17
x=(
-0.289233845935753,
0.345435683914551,
-0.712811749528561,
-0.220608525877478,
-0.430400446293923,
0.154308720294553,
-0.057822882877486,
0.201053892245385,
0.290228657818949,
)
iterative steps:15
x=(
-0.289233862597912,
0.345435685965504,
-0.712811746518780,
-0.220608520248290,
-0.430400437716334,
0.154308736772844,
-0.057822872819277,
0.201053894114224,
0.290228660532857,
)
iterative steps:16
x=(
-0.289233821416629,
0.345435715407199,
-0.712811730846937,
-0.220608509109507,
-0.430400430013429,
0.154308745138663,
-0.057822870257798,
0.201053895400330,
0.290228662723075,
)
iterative steps:17
x=(
-0.289233803995870,
0.345435729024886,
-0.712811723325070,
-0.220608503161921,
-0.430400425635718,
0.154308749736677,
-0.057822869368545,
0.201053896089075,
0.290228663956982,
)
iterative steps:17
x=(
-0.289233780635754,
0.345435745921113,
-0.712811714054052,
-0.220608496256526,
-0.430400421843990,
0.154308751149699,
-0.057822871538300,
0.201053896485941,
0.290228664915525,
)
iterative steps:17
x=(
-0.289233754635133,
0.345435763279865,
-0.712811704530482,
-0.220608489685586,
-0.430400420162416,
0.154308746638856,
-0.057822878224478,
0.201053896266931,
0.290228665120949,
)
iterative steps:17
x=(
-0.289233791910678,
0.345435729553676,
-0.712811723293451,
-0.220608506434146,
-0.430400434935807,
0.154308727790816,
-0.057822883419752,
0.201053893818101,
0.290228660916727,
)
iterative steps:18
x=(
-0.289233796032959,
0.345435723421533,
-0.712811726321352,
-0.220608510407348,
-0.430400441557318,
0.154308714446926,
-0.057822890376668,
0.201053892390645,
0.290228658868673,
)
iterative steps:18
x=(
-0.289233832639506,
0.345435699900540,
-0.712811739135330,
-0.220608519869692,
-0.430400443782769,
0.154308722596407,
-0.057822878815030,
0.201053892863152,
0.290228658703679,
)
iterative steps:19
x=(
-0.289233850153758,
0.345435686620046,
-0.712811745914435,
-0.220608526719667,
-0.430400449650937,
0.154308717034561,
-0.057822877130904,
0.201053892128433,
0.290228657188315,
)
iterative steps:19
x=(
-0.289233874820057,
0.345435668801061,
-0.712811754914358,
-0.220608535959070,
-0.430400456841825,
0.154308712360867,
-0.057822872006557,
0.201053891429962,
0.290228655447066,
)
iterative steps:19
x=(
-0.289233854967275,
0.345435690283702,
-0.712811745155326,
-0.220608524566742,
-0.430400438896183,
0.154308748129425,
-0.057822855497031,
0.201053895117293,
0.290228660736408,
)
iterative steps:20
x=(
-0.289233866364926,
0.345435685069449,
-0.712811748394765,
-0.220608528243557,
-0.430400437650177,
0.154308761074703,
-0.057822841903628,
0.201053896199111,
0.290228661463113,
)
iterative steps:20
x=(
-0.289233816822658,
0.345435720248523,
-0.712811731511195,
-0.220608509996240,
-0.430400421578045,
0.154308775372674,
-0.057822849591451,
0.201053898050403,
0.290228665430085,
)
iterative steps:21
x=(
-0.289233806675096,
0.345435729750040,
-0.712811728257714,
-0.220608506562439,
-0.430400413449623,
0.154308795611308,
-0.057822839301125,
0.201053899950625,
0.290228667798506,
)
iterative steps:21
x=(
-0.289233776478427,
0.345435744751538,
-0.712811719633195,
-0.220608495988907,
-0.430400412629132,
0.154308772207567,
-0.057822868708260,
0.201053898199049,
0.290228667266971,
)
iterative steps:22
x=(
-0.289233753686050,
0.345435759846765,
-0.712811713773168,
-0.220608488301762,
-0.430400403435843,
0.154308783779952,
-0.057822871978505,
0.201053899441925,
0.290228669557529,
)
iterative steps:22
x=(
-0.289233769952072,
0.345435742729374,
-0.712811718571836,
-0.220608492743291,
-0.430400419902317,
0.154308735805130,
-0.057822900934718,
0.201053895086194,
0.290228664671866,
)
iterative steps:23
x=(
-0.289233752296696,
0.345435751120657,
-0.712811714846461,
-0.220608485847435,
-0.430400416343100,
0.154308726978300,
-0.057822919306768,
0.201053894540568,
0.290228665221579,
)
iterative steps:23
x=(
-0.289233805971180,
0.345435714726895,
-0.712811728278347,
-0.220608503263852,
-0.430400440483061,
0.154308689034324,
-0.057822920242324,
0.201053890625721,
0.290228658962726,
)
iterative steps:24
x=(
-0.289233844640849,
0.345435693205830,
-0.712811737553641,
-0.220608517824199,
-0.430400451844098,
0.154308691683152,
-0.057822894823271,
0.201053890331291,
0.290228656461337,
)
iterative steps:25
x=(
-0.289233862552974,
0.345435680086778,
-0.712811741532841,
-0.220608522309147,
-0.430400461689276,
0.154308668871204,
-0.057822902399059,
0.201053888203205,
0.290228653790720,
)
iterative steps:25
x=(
-0.289233872356335,
0.345435681135074,
-0.712811743281841,
-0.220608529515067,
-0.430400456431498,
0.154308713388123,
-0.057822856647011,
0.201053891847996,
0.290228655956476,
)
iterative steps:26
x=(
-0.289233848025088,
0.345435701269048,
-0.712811737442274,
-0.220608524306562,
-0.430400439778812,
0.154308760344096,
-0.057822831591144,
0.201053896175728,
0.290228660767014,
)
iterative steps:27
x=(
-0.289233859994322,
0.345435697466984,
-0.712811738868958,
-0.220608529766648,
-0.430400441611538,
0.154308774472278,
-0.057822808221977,
0.201053897238550,
0.290228660698878,
)
iterative steps:27
x=(
-0.289233807312146,
0.345435731012902,
-0.712811727565637,
-0.220608513329881,
-0.430400418092115,
0.154308808454180,
-0.057822816790243,
0.201053900773159,
0.290228666706830,
)
iterative steps:28
x=(
-0.289233798692009,
0.345435741593313,
-0.712811724346614,
-0.220608513418684,
-0.430400409892675,
0.154308843636356,
-0.057822789525489,
0.201053903829932,
0.290228669288113,
)
iterative steps:28
x=(
-0.289233748395566,
0.345435764954622,
-0.712811716131474,
-0.220608493889327,
-0.430400396168925,
0.154308824036509,
-0.057822850028558,
0.201053902649545,
0.290228671754690,
)
iterative steps:29
x=(
-0.289233792672515,
0.345435722831806,
-0.712811728984335,
-0.220608500287433,
-0.430400429462725,
0.154308711045299,
-0.057822921846893,
0.201053892528222,
0.290228661773726,
)
iterative steps:31
x=(
-0.289233783481601,
0.345435724084041,
-0.712811729196505,
-0.220608496062412,
-0.430400428843038,
0.154308694157532,
-0.057822948194692,
0.201053891135660,
0.290228661423422,
)
iterative steps:31
x=(
-0.289233835027271,
0.345435691351587,
-0.712811739458308,
-0.220608511002829,
-0.430400450908594,
0.154308661541126,
-0.057822934819629,
0.201053888012852,
0.290228656064100,
)
iterative steps:32
x=(
-0.289233846954353,
0.345435677290920,
-0.712811744614529,
-0.220608511906783,
-0.430400460327464,
0.154308621846527,
-0.057822965250156,
0.201053884593207,
0.290228653137759,
)
iterative steps:32
x=(
-0.289233870780861,
0.345435686608347,
-0.712811738412625,
-0.220608526803272,
-0.430400452131445,
0.154308728701690,
-0.057822831144166,
0.201053893689594,
0.290228657914322,
)
iterative steps:34
x=(
-0.289233838565070,
0.345435714615762,
-0.712811728741365,
-0.220608520324271,
-0.430400433539917,
0.154308785358887,
-0.057822801994792,
0.201053898627024,
0.290228663113211,
)
iterative steps:35
x=(
-0.289233848071486,
0.345435715931833,
-0.712811726324197,
-0.220608524420382,
-0.430400433321870,
0.154308810007538,
-0.057822763935149,
0.201053900702115,
0.290228663934231,
)
iterative steps:35
x=(
-0.289233780479973,
0.345435758276513,
-0.712811714655019,
-0.220608507315105,
-0.430400406302785,
0.154308853357794,
-0.057822785710597,
0.201053904388416,
0.290228669958062,
)
iterative steps:36
x=(
-0.289233762332403,
0.345435742090179,
-0.712811726537331,
-0.220608496229847,
-0.430400415034141,
0.154308746790167,
-0.057822923876174,
0.201053895401549,
0.290228665021676,
)
iterative steps:38
x=(
-0.289233796565940,
0.345435711467678,
-0.712811737354942,
-0.220608502373078,
-0.430400433431247,
0.154308685846238,
-0.057822956675002,
0.201053890341066,
0.290228660054248,
)
iterative steps:39
x=(
-0.289233787495424,
0.345435707942434,
-0.712811741658975,
-0.220608498772158,
-0.430400434041044,
0.154308657143296,
-0.057823001874558,
0.201053887962867,
0.290228659019200,
)
iterative steps:39
x=(
-0.289233861996831,
0.345435661560635,
-0.712811752995377,
-0.220608515235069,
-0.430400462550633,
0.154308605918077,
-0.057822977585248,
0.201053883950541,
0.290228653094154,
)
iterative steps:40
最佳松弛因子:1.200000000000000，迭代步数:15
 */
#include <stdio.h>
#include <math.h>
#include <limits.h>

#define MATRIX_SIZE 9
#define ERROR_THRESHOLD 1E-7


typedef struct {
    int steps;
    double x[MATRIX_SIZE];
} RES;

/**
 * @brief Gauss-Seidel Algorithm for solving linear equations Ax = b with error ERROR_THRESHOLD
 * @param A input: Coefficient matrix
 * @param b input: Constant terms
 * @param x output: The unknowns
 */
void gaussSeidel(double A[][MATRIX_SIZE], double b[MATRIX_SIZE], RES *result) {
    int flag = 0; // 指示|x-x1|的无穷范数是否小于误差限
    double x1[MATRIX_SIZE] = {0};
    result->steps = 0;
    while (flag == 0) {
        result->steps++;
        for (int i = 0; i < MATRIX_SIZE; i++) {
            x1[i] = result->x[i];
        }
        for (int i = 0; i < MATRIX_SIZE; i++) {
            double s = 0;
            for (int j = 0; j < MATRIX_SIZE; j++) {
                s = s + A[i][j] * result->x[j];
            }
            result->x[i] = (b[i] - s + A[i][i] * result->x[i]) / A[i][i];
        }
        // 检验迭代是否结束
        flag = 1;
        for (int i = 0; i < MATRIX_SIZE; i++) {
            if (fabs(result->x[i] - x1[i]) > ERROR_THRESHOLD) {
                flag = 0;
            }
        }
    }
}

/**
 * @brief SOR Algorithm for solving linear equations Ax=b with error ERROR_THRESHOLD
 * @param A input: Coefficient matrix
 * @param b input: Constant terms
 * @param w input: relaxation factor
 * @param x output: The unknowns
 */
void SOR(double A[][MATRIX_SIZE], double b[MATRIX_SIZE], double w, RES *result) {
    int flag = 0; // 指示|x-x1|的无穷范数是否小于误差限
    double x1[MATRIX_SIZE] = {0};
    result->steps = 0;
    while (flag == 0) {
        result->steps++;
        for (int i = 0; i < MATRIX_SIZE; i++) {
            x1[i] = result->x[i];
        }
        for (int i = 0; i < MATRIX_SIZE; i++) {
            double s = 0;
            for (int j = 0; j < MATRIX_SIZE; j++) {
                s = s + A[i][j] * ((1 - w) * x1[j] + w * result->x[j]);
            }
            result->x[i] = (b[i] - s + A[i][i] * x1[i]) / A[i][i];
        }
        // 检验迭代是否结束
        flag = 1;
        for (int i = 0; i < MATRIX_SIZE; i++) {
            if (fabs(result->x[i] - x1[i]) > ERROR_THRESHOLD) {
                flag = 0;
            }
        }
    }
}

int main() {
    double A[9][9] = {
            {31,  -13, 0,   0,   0,   -10, 0,   0,  0},
            {-13, 35,  -9,  0,   -11, 0,   0,   0,  0},
            {0,   -9,  31,  -10, 0,   0,   0,   0,  0},
            {0,   0,   -10, 79,  -30, 0,   0,   0,  -9},
            {0,   0,   0,   -30, 57,  -7,  0,   -5, 0},
            {0,   0,   0,   0,   -7,  47,  -30, 0,  0},
            {0,   0,   0,   0,   0,   -30, 41,  0,  0},
            {0,   0,   0,   0,   -5,  0,   0,   27, -2},
            {0,   0,   0,   -9,  0,   0,   0,   -2, 29}
    };
    double b[9] = {-15, 27, -23, 0, -20, 12, -7, 7, 10};
    RES gaussResult = {0, {0,0,0,0,0,0,0,0,0}};
    gaussSeidel(A, b, &gaussResult);
    puts("Gauss-Seidel Result:");
    for (int i = 0; i < MATRIX_SIZE; i++) {
        if (i == 0) {
            printf("x=(\n%.15f,\n", gaussResult.x[0]);
        } else {
            printf("%.15f,\n", gaussResult.x[i]);
        }
    }
    printf(")\n");
    printf("iterative steps:%d\n",gaussResult.steps);
    puts("SOR Result:");
    int k = 0;
    int min_steps = INT_MAX;
    for(int n=1;n<=99;n++) {
        RES sorResult = {0, {0,0,0,0,0,0,0,0,0}};
        SOR(A, b, n / 50.0, &sorResult);
        printf("");
        for (int i = 0; i < MATRIX_SIZE; i++) {
            if (i == 0) {
                printf("x=(\n%.15f,\n", sorResult.x[0]);
            } else {
                printf("%.15f,\n", sorResult.x[i]);
            }
        }
        printf(")\n");
        printf("iterative steps:%d\n", sorResult.steps);
        if(sorResult.steps<min_steps){
            min_steps = sorResult.steps;
            k = n;
        }
    }
    printf("最佳松弛因子:%.15f，迭代步数:%d\n",k/50.0,min_steps);
    return 0;
}